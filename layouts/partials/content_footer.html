<!-- ======================================================= -->
<!-- 1. 原生页脚区 (保留所有原有按钮) -->
<!-- ======================================================= -->
<footer class="main-footer footer-type-1 text-xs">
    <div id="footer-tools" class="d-flex flex-column">
        <!-- 回到顶部 -->
        <a href="javascript:" id="go-to-up" class="btn rounded-circle go-up m-1" rel="go-top">
            <i class="iconfont icon-to-up"></i>
        </a>
        
        <!-- 搜索 -->
        <a href="javascript:" data-toggle="modal" data-target="#search-modal" class="btn rounded-circle m-1" rel="search" one-link-mark="yes">
            <i class="iconfont icon-search"></i>
        </a>
        
        <!-- 客服 -->
        <a href="https://github.com/shenweiyan/WebStack-Hugo" class="btn rounded-circle kefu m-1" target="_blank" data-toggle="tooltip" data-placement="left" title="联系我们">
            <i class="mode-ico iconfont icon-qq"></i>
        </a>
        
        <!-- 夜间模式切换 (核心) -->
        {{ if $.Site.Params.nightMode }}
        <a href="javascript:" onclick="window.location.href='javascript:switchNightMode()'" class="btn rounded-circle switch-dark-mode m-1" id="yejian"
            data-toggle="tooltip" data-placement="left" title="夜间模式">
            <i class="mode-ico iconfont icon-light"></i>
        </a>
        {{ else }}
        <a href="javascript:" onclick="window.location.href='javascript:switchNightMode()'" class="btn rounded-circle switch-dark-mode m-1" id="yejian"
            data-toggle="tooltip" data-placement="left" title="日间模式">
            <i class="mode-ico iconfont icon-night"></i>
        </a>
        {{ end }}
    </div>

    <!-- 版权信息 -->
    <div class="footer-inner">
        <div class="footer-text">
            &copy; 2025 <strong>我的专属导航站</strong> | 
            <a href="https://github.com/WebStackPage/WebStack-Hugo" target="_blank">WebStack-Hugo</a>
        </div>
    </div>
</footer>

<!-- ======================================================= -->
<!-- 2. 天气胶囊容器 (等待脚本搬运) -->
<!-- ======================================================= -->
<div id="weather-capsule-layer" style="display: none;">
    <div id="weather-capsule-real" style="
        position: fixed; 
        top: 20px; 
        left: 50%; 
        transform: translateX(-50%); 
        z-index: 2147483647; /* 保证最顶层 */
        
        /* 磨砂玻璃外观 */
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        border-radius: 50px;
        
        /* 布局 */
        padding: 5px 20px;
        display: flex;
        align-items: center; 
        justify-content: center;
        gap: 15px;
        
        /* 字体 */
        font-family: -apple-system, sans-serif;
        color: #333;
        white-space: nowrap;
        pointer-events: auto;
    ">
       <!-- 左侧：时间 -->
       <div style="text-align: center; line-height: 1.1; min-width: 70px;">
           <div id="clock-time" style="font-size: 22px; font-weight: 700; color: #1d1d1f;">00:00</div>
           <div id="clock-date" style="font-size: 10px; color: #666; margin-top: 2px;">Loading...</div>
       </div>
       
       <!-- 分隔线 -->
       <div style="width: 1px; height: 30px; background: rgba(0,0,0,0.15);"></div>

       <!-- 右侧：中国天气网 -->
       <div style="display: flex; align-items: center; justify-content: center;">
           <iframe scrolling="no" src="https://i.tianqi.com/index.php?c=code&id=10&color=%23333&icon=1&site=12" frameborder="0" width="240" height="25" allowtransparency="true"></iframe>
       </div>
    </div>
</div>

<!-- ======================================================= -->
<!-- 3. 搬运脚本 (极其简单，不易出错) -->
<!-- ======================================================= -->
<script>
    (function() {
        function initWeatherBar() {
            // 1. 找到源元素
            var layer = document.getElementById('weather-capsule-layer');
            var realCapsule = document.getElementById('weather-capsule-real');
            
            // 2. 如果元素存在且还没被搬运
            if (layer && realCapsule && document.body) {
                // 3. 将真正的胶囊移动到 body 最下面 (脱离 footer 限制)
                document.body.appendChild(realCapsule);
                // 4. 清理旧容器
                layer.remove();
            }
            
            // 5. 启动时钟
            startClock();
        }

        function startClock() {
            var timeEl = document.getElementById('clock-time');
            var dateEl = document.getElementById('clock-date');
            
            if (!timeEl) return;

            function update() {
                var now = new Date();
                // 时间
                var h = now.getHours().toString().padStart(2, '0');
                var m = now.getMinutes().toString().padStart(2, '0');
                timeEl.innerText = h + ':' + m;
                
                // 日期
                var m = now.getMonth() + 1;
                var d = now.getDate();
                // 简单的星期数组
                var weeks = ["周日", "周一", "周二", "周三", "周四", "周五", "周六"];
                var w = weeks[now.getDay()];
                dateEl.innerText = m + '月' + d + '日 ' + w;
            }
            
            update();
            setInterval(update, 1000);
        }

        // 双重保险启动 (防止页面没加载完找不到 body)
        // 1. 立即执行一次
        initWeatherBar();
        // 2. 页面加载完毕后再执行一次
        window.addEventListener('load', initWeatherBar);

    })();
</script>
